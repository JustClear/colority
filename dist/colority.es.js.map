{"version":3,"file":"colority.es.js","sources":["../src/index.ts"],"sourcesContent":["export default function colority(imageURL: string, callback: (colors: []) => void, options?: {\n    skip: number\n}) {\n    if (!(this instanceof colority)) return new colority(imageURL, callback, options);\n\n    this.imageURL = imageURL;\n    this.options = {};\n    this.callback = () => {};\n\n    if (options === undefined) {\n        this.callback = callback;\n    } else {\n        this.options = callback;\n        this.callback = options;\n    }\n\n    preload(this.imageURL, image => {\n        const context = getContext(image.naturalWidth, image.naturalHeight);\n        context.drawImage(image, 0, 0);\n        const imageData = context.getImageData(0, 0, image.naturalWidth, image.naturalHeight).data;\n        const colors = {};\n        const results = [];\n\n        transformColors(imageData, this.options.skip || 10, rgb => colors[rgb] = rgb in colors ? colors[rgb] + 1 : 1);\n\n        mapColors(colors, (key, value) => {\n            results.push({\n                color: key,\n                count: value,\n            });\n        });\n        this.callback(results.sort((a, b) => b.count - a.count).map(result => result.color));\n    });\n}\n\nfunction preload(imageURL: string, done: (image: HTMLImageElement) => void) {\n    const image: HTMLImageElement = new Image();\n    image.crossOrigin = '*';\n    image.src = imageURL;\n    image.addEventListener('load', () => done(image));\n    image.addEventListener('error', () => done(image));\n}\n\nfunction getContext(width: number, height: number): CanvasRenderingContext2D {\n    const canvas: HTMLCanvasElement = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    return canvas.getContext('2d');\n}\n\nfunction transformColors(data: Uint8ClampedArray, skip: number, callback: (color: string) => void) {\n    for (let i = 0; i < data.length; i += 4 * skip) {\n        callback(`rgb(${data[i]},${data[i + 1]},${data[i + 2]})`);\n    }\n}\n\nfunction mapColors(data: object, callback: (key: string, value: any) => void) {\n    for (let key in data) {\n        callback(key, data[key]);\n    }\n}\n"],"names":[],"mappings":"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"}