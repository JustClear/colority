{"version":3,"file":"colority.min.js","sources":["../src/common.js","../src/index.js"],"sourcesContent":["export function preload(imageURLs, done) {\n    const images = [];\n    let count = 0;\n    imageURLs = (typeof imageURLs != 'object') ? [imageURLs] : imageURLs;\n\n    imageURLs.length === 0 && done(images);\n\n    imageURLs.map(imageURL => {\n        const image = new Image();\n        image.crossOrigin = '*';\n        image.src = imageURL;\n        image.addEventListener('load', imageOnLoad);\n        image.addEventListener('error', imageOnLoad);\n        images.push(image);\n    });\n\n    function imageOnLoad() {\n        count ++;\n        if (count == imageURLs.length) done(images);\n    }\n}\n\nexport function getContext(width = 0, height = 0) {\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    return canvas.getContext('2d');\n}\n\nexport function transformColors(data, skip, callback) {\n    for (let i = 0; i < data.length; i += 4 * skip) {\n        callback(`rgb(${data[i]},${data[i + 1]},${data[i + 2]})`);\n    }\n}\n\nexport function mapColors(data, callback) {\n    for (let key in data) {\n        callback(key, data[key]);\n    }\n}\n","import { preload, getContext, transformColors, mapColors } from './common';\n\nexport default function colority() {\n    if (!(this instanceof colority)) return new colority(...arguments);\n\n    const argument = [...arguments];\n    this.imageURL = ``;\n    this.options = {};\n    this.callback = () => {};\n\n    if (typeof argument[0] === 'string') {\n        this.imageURL = argument[0];\n        if (typeof argument[2] === 'function') {\n            this.callback = argument[2];\n            this.options = typeof argument[1] == 'object' ? argument[1] : this.options;\n        } else {\n            this.callback = typeof argument[1] == 'function' ? argument[1] : this.callback;\n        }\n    } else {\n        console.log(`first param in \"colority()\" must be string.`);\n    }\n\n    preload(this.imageURL, ([image]) => {\n        const context = getContext(image.naturalWidth, image.naturalHeight);\n        context.drawImage(image, 0, 0);\n        const imageData = context.getImageData(0, 0, image.naturalWidth, image.naturalHeight).data;\n        const colors = {};\n        const results = [];\n\n        transformColors(imageData, this.options.skip || 10, rgb => colors[rgb] = rgb in colors ? colors[rgb] + 1 : 1);\n        mapColors(colors, (key, value) => {\n            results.push({\n                color: key,\n                count: value,\n            });\n        });\n        this.callback(results.sort((a, b) => b.count - a.count).map(result => result.color));\n    });\n}\n"],"names":["preload","imageURLs","done","imageOnLoad","length","images","count","map","image","Image","crossOrigin","src","imageURL","addEventListener","push","getContext","width","height","canvas","document","createElement","transformColors","data","skip","callback","i","mapColors","key","colority","this","arguments","argument","options","_typeof","log","context","naturalWidth","naturalHeight","drawImage","colors","results","getImageData","_this","rgb","value","sort","a","b","result","color"],"mappings":"+LAAA,SAAgBA,EAAQC,EAAWC,YAgBtBC,SAEQF,EAAUG,QAAQF,EAAKG,OAjBlCA,KACFC,EAAQ,EAGS,OAFY,oBAAbL,gBAAAA,KAA0BA,GAAaA,GAEjDG,QAAgBF,EAAKG,KAErBE,IAAI,gBACJC,EAAQ,IAAIC,QACZC,YAAc,MACdC,IAAMC,IACNC,iBAAiB,OAAQV,KACzBU,iBAAiB,QAASV,KACzBW,KAAKN,KASpB,SAAgBO,QAAWC,yDAAQ,EAAGC,yDAAS,EACrCC,EAASC,SAASC,cAAc,mBAC/BJ,MAAQA,IACRC,OAASA,EACTC,EAAOH,WAAW,MAG7B,SAAgBM,EAAgBC,EAAMC,EAAMC,OACnC,IAAIC,EAAI,EAAGA,EAAIH,EAAKlB,OAAQqB,GAAK,EAAIF,WACtBD,EAAKG,OAAMH,EAAKG,EAAI,OAAMH,EAAKG,EAAI,QAI3D,SAAgBC,EAAUJ,EAAME,OACvB,IAAIG,KAAOL,IACHK,EAAKL,EAAKK,ICrC3B,SAEwBC,oBACdC,gBAAgBD,GAAW,yCAAWA,2CAAYE,kBAElDC,uCAAeD,iBAChBlB,iBACAoB,gBACAR,SAAW,aAEW,iBAAhBO,EAAS,SACXnB,SAAWmB,EAAS,GACE,mBAAhBA,EAAS,SACXP,SAAWO,EAAS,QACpBC,QAAgC,UAAtBC,EAAOF,EAAS,IAAiBA,EAAS,GAAKF,KAAKG,cAE9DR,SAAiC,mBAAfO,EAAS,GAAmBA,EAAS,GAAKF,KAAKL,kBAGlEU,qDAGJL,KAAKjB,SAAU,gBAAEJ,YACf2B,EAAUpB,EAAWP,EAAM4B,aAAc5B,EAAM6B,iBAC7CC,UAAU9B,EAAO,EAAG,OAEtB+B,KACAC,OAFYL,EAAQM,aAAa,EAAG,EAAGjC,EAAM4B,aAAc5B,EAAM6B,eAAef,KAI3DoB,EAAKV,QAAQT,MAAQ,GAAI,mBAAOgB,EAAOI,GAAOA,KAAOJ,EAASA,EAAOI,GAAO,EAAI,MACjGJ,EAAQ,SAACZ,EAAKiB,KACZ9B,YACGa,QACAiB,QAGVpB,SAASgB,EAAQK,KAAK,SAACC,EAAGC,UAAMA,EAAEzC,MAAQwC,EAAExC,QAAOC,IAAI,mBAAUyC,EAAOC"}