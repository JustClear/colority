{"version":3,"file":"colority.min.js","sources":["../src/index.ts"],"sourcesContent":["export default function colority(imageURL: string, callback: (colors: []) => void, options?: {\n    skip: number\n}) {\n    if (!(this instanceof colority)) return new colority(imageURL, callback, options);\n\n    this.imageURL = imageURL;\n    this.options = {};\n    this.callback = () => {};\n\n    if (options === undefined) {\n        this.callback = callback;\n    } else {\n        this.options = callback;\n        this.callback = options;\n    }\n\n    preload(this.imageURL, image => {\n        const context = getContext(image.naturalWidth, image.naturalHeight);\n        context.drawImage(image, 0, 0);\n        const imageData = context.getImageData(0, 0, image.naturalWidth, image.naturalHeight).data;\n        const colors = {};\n        const results = [];\n\n        transformColors(imageData, this.options.skip || 10, rgb => colors[rgb] = rgb in colors ? colors[rgb] + 1 : 1);\n\n        mapColors(colors, (key, value) => {\n            results.push({\n                color: key,\n                count: value,\n            });\n        });\n        this.callback(results.sort((a, b) => b.count - a.count).map(result => result.color));\n    });\n}\n\nfunction preload(imageURL: string, done: (image: HTMLImageElement) => void) {\n    const image: HTMLImageElement = new Image();\n    image.crossOrigin = '*';\n    image.src = imageURL;\n    image.addEventListener('load', () => done(image));\n    image.addEventListener('error', () => done(image));\n}\n\nfunction getContext(width: number, height: number): CanvasRenderingContext2D {\n    const canvas: HTMLCanvasElement = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    return canvas.getContext('2d');\n}\n\nfunction transformColors(data: Uint8ClampedArray, skip: number, callback: (color: string) => void) {\n    for (let i = 0; i < data.length; i += 4 * skip) {\n        callback(`rgb(${data[i]},${data[i + 1]},${data[i + 2]})`);\n    }\n}\n\nfunction mapColors(data: object, callback: (key: string, value: any) => void) {\n    for (let key in data) {\n        callback(key, data[key]);\n    }\n}\n"],"names":["colority","imageURL","callback","options","preload","image","context","getContext","naturalWidth","naturalHeight","drawImage","imageData","getImageData","data","colors","results","transformColors","_this","skip","rgb","mapColors","key","value","push","color","count","sort","a","b","map","result","done","Image","crossOrigin","src","addEventListener","width","height","canvas","document","createElement","i","length"],"mappings":"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"}