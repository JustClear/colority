{"version":3,"file":"colority.js","sources":["../src/common.js","../src/index.js"],"sourcesContent":["export function preload(imageURLs, done) {\n    const images = [];\n    let count = 0;\n    imageURLs = (typeof imageURLs != 'object') ? [imageURLs] : imageURLs;\n\n    imageURLs.length === 0 && done(images);\n\n    imageURLs.map(imageURL => {\n        const image = new Image();\n        image.crossOrigin = '*';\n        image.src = imageURL;\n        image.addEventListener('load', imageOnLoad);\n        image.addEventListener('error', imageOnLoad);\n        images.push(image);\n    });\n\n    function imageOnLoad() {\n        count ++;\n        if (count == imageURLs.length) done(images);\n    }\n}\n\nexport function getContext(width = 0, height = 0) {\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    return canvas.getContext('2d');\n}\n\nexport function transformColors(data, skip, callback) {\n    for (let i = 0; i < data.length; i += 4 * skip) {\n        callback(`rgb(${data[i]},${data[i + 1]},${data[i + 2]})`);\n    }\n}\n\nexport function mapColors(data, callback) {\n    for (let key in data) {\n        callback(key, data[key]);\n    }\n}\n","import { preload, getContext, transformColors, mapColors } from './common';\n\nexport default function colority() {\n    if (!(this instanceof colority)) return new colority(...arguments);\n\n    const argument = [...arguments];\n    this.imageURL = ``;\n    this.options = {};\n    this.callback = () => {};\n\n    if (typeof argument[0] === 'string') {\n        this.imageURL = argument[0];\n        if (typeof argument[2] === 'function') {\n            this.callback = argument[2];\n            this.options = typeof argument[1] == 'object' ? argument[1] : this.options;\n        } else {\n            this.callback = typeof argument[1] == 'function' ? argument[1] : this.callback;\n        }\n    } else {\n        console.log(`first param in \"colority()\" must be string.`);\n    }\n\n    preload(this.imageURL, ([image]) => {\n        const context = getContext(image.naturalWidth, image.naturalHeight);\n        context.drawImage(image, 0, 0);\n        const imageData = context.getImageData(0, 0, image.naturalWidth, image.naturalHeight).data;\n        const colors = {};\n        const results = [];\n\n        transformColors(imageData, this.options.interval || 10, rgb => colors[rgb] = rgb in colors ? colors[rgb] + 1 : 1);\n        mapColors(colors, (key, value) => {\n            results.push({\n                color: key,\n                count: value,\n            });\n        });\n        this.callback(results.sort((a, b) => b.count - a.count).map(result => result.color));\n    });\n}\n"],"names":["preload","imageURLs","done","images","count","length","map","image","Image","crossOrigin","src","imageURL","addEventListener","imageOnLoad","push","getContext","width","height","canvas","document","createElement","transformColors","data","skip","callback","i","mapColors","key","colority","arguments","argument","options","log","context","naturalWidth","naturalHeight","drawImage","imageData","getImageData","colors","results","interval","rgb","value","sort","a","b","result","color"],"mappings":"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"}